services:
  backend:
    build: ./backend
    container_name: ixc-reporting-backend
    ports:
      - "8000:8000"
    environment:
      - IXC_BASE_URL=${IXC_BASE_URL}
      - IXC_API_TOKEN=${IXC_API_TOKEN}
      - IXC_USER_ID=${IXC_USER_ID}
      - IXC_PAGE_SIZE=${IXC_PAGE_SIZE}
      - IXC_CACHE_TTL=${IXC_CACHE_TTL}
      - IXC_DATA_CACHE_TTL_HOURS=${IXC_DATA_CACHE_TTL_HOURS}
      - IXC_DATA_CACHE_PATH=/app/data/cache.json
      - DEBUG=${DEBUG}
    volumes:
      - ./backend/data:/app/data
    restart: unless-stopped

  frontend:
    build: ./frontend
    container_name: ixc-reporting-frontend
    ports:
      - "8502:8501"
    environment:
      - API_BASE_URL=http://backend:8000
      - STREAMLIT_SERVER_PORT=8501
      - STREAMLIT_SERVER_ADDRESS=0.0.0.0
      - STREAMLIT_BROWSER_SERVER_PORT=8502
      - STREAMLIT_BROWSER_SERVER_ADDRESS=localhost
      - STREAMLIT_SERVER_HEADLESS=true
      - STREAMLIT_SERVER_ENABLE_CORS=false
      - STREAMLIT_SERVER_ENABLE_XSRF_PROTECTION=false
      - STREAMLIT_BROWSER_GATHER_USAGE_STATS=false
      - STREAMLIT_SERVER_FILE_WATCHER_TYPE=none
    depends_on:
      - backend
    restart: unless-stopped
